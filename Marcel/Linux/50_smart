# Publish Disks' S.M.A.R.T alerts
#
# Topic :
# Machines/<host>/SMART
#
# Instead of forking smartctl, this version relies on a log file generated by smartd
# So following steps have to be done :
#
# 	1/ Create helper script cat /usr/local/share/smartlog.sh
#
# 	****
# 		#!/bin/sh
# 		# Notify smartd's errors
#
# 		echo "$SMARTD_DEVICESTRING" "$SMARTD_MESSAGE" > /tmp/smartd.msg
# 	****
#
#	2/ In smartd.conf, the only active line has to be
#
#		DEVICESCAN -m <nomailer> -M exec /usr/local/share/smartlog.sh
#
#	3/ restart smartd
#
# Copyright 2013-2024 Laurent Faillie
# ---------
#
# 19/03/2013	First version
# 21/09/2024	Migrate to Marcels

Needs=mod_every
Needs=mod_Lua

UserFuncScript=scripts/PublishSmart.lua

*Every=Publish smart
	Sample=15
	Func=PublishSmart
	Immediate
#	Disabled
	DoNotSimulate
